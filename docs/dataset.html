---

title: Data-Set

keywords: fastai
sidebar: home_sidebar

summary: "Data-Set Notes."
description: "Data-Set Notes."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: dataset.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Creating a data-set for a classification or segmentation task. If an annotation file is present, the annotations are also prepared.
The data-set is created based on an image-set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Image-Set">Image-Set<a class="anchor-link" href="#Image-Set"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Image-sets are collected images to build a data-set from, stored in the <code>imagesets</code> folder.
The <code>imagesets</code> folder contains the following folder structure:</p>
<ul>
<li>imagesets/<em>[image_set_type]</em>/<em>[image_set_name]</em></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inside the <code>[image_set_name]</code> folder are the following files / folders</p>
<ul>
<li><code>test/</code>: test images (benchmark)</li>
<li><code>trainval/</code>: training and validation images for <a href="https://pdc-pj.backlog.jp/wiki/RAD_RAD/Neural+Network+-+Training">cross validation</a></li>
<li><code>categories.txt</code>: all categories (classes) the image-set contains</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Categories-(Classes)">Categories (Classes)<a class="anchor-link" href="#Categories-(Classes)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Category names of an image-set or data-set are written in plain text, separated by a <em>new line</em> and stored in a file <code>categories.txt</code>.
The order of the category names is important and reflects the index of the result vector for easy mapping.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_categories" class="doc_header"><code>read_categories</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L55" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_categories</code>(<strong><code>categories_file</code></strong>)</p>
</blockquote>
<p>Reads the categories from a categories file.
If the optional <code>categories_file</code> is not given, the file name <em>categories.txt</em> is used by default
<code>path</code>: The folder, the categories file is stored in
<code>categories_file</code>: the categories file name, if not the default
return: a list of the category names</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Set-Folders">Data-Set Folders<a class="anchor-link" href="#Data-Set-Folders"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Data-sets are stored in the <code>datasets</code> base folder.
The <code>datasets</code> folder contains the following folder structure:</p>
<ul>
<li>datasets/<em>[data_set_type]</em>/<em>[data_set_name]</em>
where <code>[data_set_type]</code> is the same as the corresponding <code>[image_set_type]</code> and <code>[data_set_name]</code> is the same as the corresponding <code>[image_set_name]</code>.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inside the <code>[data_set_name]</code> folder are the following files / folders</p>
<ul>
<li><code>test/</code>: test set (benchmark)</li>
<li><code>train/</code>: training set</li>
<li><code>val/</code>: validation set</li>
<li><code>categories.txt</code>: all categories (classes) the data-set contains</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DataSet" class="doc_header"><code>class</code> <code>DataSet</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L73" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>DataSet</code>(<strong><code>name</code></strong>, <strong><code>base_path</code></strong>, <strong><code>image_set_path</code></strong>, <strong><code>categories_path</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-classification-data-set">Create a classification data-set<a class="anchor-link" href="#Create-a-classification-data-set"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Classification data-set can be created from a classification image-set. 
All images are validated, if they belong to one of the given categories. If categories with no images are found or images belong to a category not listed in <code>categories.txt</code>, the data-set can not be created.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ClassificationDataSet" class="doc_header"><code>class</code> <code>ClassificationDataSet</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L143" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ClassificationDataSet</code>(<strong><code>name</code></strong>, <strong><code>base_path</code></strong>, <strong><code>image_set_path</code></strong>, <strong><code>categories_path</code></strong>, <strong><code>annotations_path</code></strong>=<em><code>None</code></em>) :: <a href="/ML-Core-Docs/dataset#DataSet"><code>DataSet</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-segmentation-data-set">Create a segmentation data-set<a class="anchor-link" href="#Create-a-segmentation-data-set"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Segmentation data-set can be created from a segmentation image-set.
All images are validated against the annotations, if they contain at least one annotation and that the annotation category belongs to one of the given categories. The annotations have to be in <a href="http://www.robots.ox.ac.uk/~vgg/software/via/via-1.0.5.html">VIA v1</a> json format. Rectangle annotations are converted into polygon annotations for unique segment generation.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SegmentationDataSet" class="doc_header"><code>class</code> <code>SegmentationDataSet</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L410" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SegmentationDataSet</code>(<strong><code>name</code></strong>, <strong><code>base_path</code></strong>, <strong><code>image_set_path</code></strong>, <strong><code>categories_path</code></strong>, <strong><code>annotations_path</code></strong>=<em><code>None</code></em>) :: <a href="/ML-Core-Docs/dataset#DataSet"><code>DataSet</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Helper-Methods">Helper Methods<a class="anchor-link" href="#Helper-Methods"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scan_files" class="doc_header"><code>scan_files</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L804" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scan_files</code>(<strong><code>folder</code></strong>, <strong><code>file_extensions</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Scan the folder for files and filter files by file extension.
If the optional <code>file_extension</code> is not set, <strong>.jpg</strong> as file extension is used by default.
<code>folder</code>: the folder to scan for files
<code>file_extensions</code>: the allowed file extensions
return: the file path list</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scan_path" class="doc_header"><code>scan_path</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L830" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scan_path</code>(<strong><code>path</code></strong>)</p>
</blockquote>
<p>Scan a folder and subfolders until the file level.
<code>path</code>: the current directory to parse for folders
return: a list of folders prefixed with base directory</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="delete_folder" class="doc_header"><code>delete_folder</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L851" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>delete_folder</code>(<strong><code>path</code></strong>)</p>
</blockquote>
<p>Deletes a Folder, if exist.
<code>path</code>: the folder path including the folder name
return: the created folder path</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_folder" class="doc_header"><code>create_folder</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L864" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_folder</code>(<strong><code>path</code></strong>, <strong><code>clear</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Creates a Folder, if not exist.
<code>path</code>: the folder path including the folder name
<code>clear</code>: wherether or not the created folder should be empty
return: the created folder path</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_train_val_data" class="doc_header"><code>split_train_val_data</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L884" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_train_val_data</code>(<strong><code>data</code></strong>, <strong><code>val_size</code></strong>=<em><code>0.2</code></em>, <strong><code>seed</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Splits the images in train and validation set
<code>data</code>: the data to split
<code>val_size</code>: the size of the validation set in percentage
<code>seed</code>: A random seed to reproduce splits.
return: the splittet train, validation images</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="input_feedback" class="doc_header"><code>input_feedback</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L900" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>input_feedback</code>(<strong><code>msg</code></strong>, <strong><code>choice</code></strong>, <strong><code>choices</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="configure_logging" class="doc_header"><code>configure_logging</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L914" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>configure_logging</code>(<strong><code>logging_level</code></strong>=<em><code>20</code></em>)</p>
</blockquote>
<p>Configures logging for the system.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Build-a-data-set">Build a data-set<a class="anchor-link" href="#Build-a-data-set"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To build a data-set from an image-set. Handles currently classification and segmentation image-sets taken from the image-set-type, which is the parent folder, the image-set folder is located in.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_data_set" class="doc_header"><code>build_data_set</code><a href="https://github.com/s-rettig/mlcore/tree/master/mlcore/dataset.py#L934" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_data_set</code>(<strong><code>category_file_path</code></strong>, <strong><code>annotation_file_path</code></strong>, <strong><code>split</code></strong>, <strong><code>seed</code></strong>, <strong><code>sample</code></strong>, <strong><code>output</code></strong>)</p>
</blockquote>
<p>Build the data-set for training, Validation and test
<code>category_file_path</code>: the filename of the categories file
<code>annotation_file_path</code>: the file path to the annotation file
<code>split</code>: the size of the validation set as percentage
<code>seed</code>: random seed to reproduce splits
<code>sample</code>: the size of the sample set as percentage
<code>output</code>: the dataset base folder to build the dataset in</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Run-from-command-line">Run from command line<a class="anchor-link" href="#Run-from-command-line"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To run the data-set builder from command line, use the following command:
<code>python -m mlcore.dataset [parameters]</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following parameters are supported:</p>
<ul>
<li><code>[categories]</code>: The path to the categories file. (e.g.: <em>categories.txt</em>)</li>
<li><code>--annotation</code>: The path to the annotation file, the data-set is build from. (e.g.: <em>imagesets/classification/car_damage/annotations.csv</em> for classification, <em>imagesets/segmentation/car_damage/via_region_data.json</em> for segmentation)</li>
<li><code>--split</code>: The percentage of the data which belongs to validation set, default to <em>0.2</em> (=20%)</li>
<li><code>--seed</code>: A random seed to reproduce splits, default to None</li>
<li><code>--category-label-key</code>: The key, the category name can be found in the annotation file, default to <em>name</em>.</li>
<li><code>--sample</code>: The percentage of the data which will be copied as a sample set with in a separate folder with "_sample" suffix. If not set, no sample data-set will be created.</li>
<li><code>--output</code>: The path of the dataset folder, default to <em>../datasets</em>.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

